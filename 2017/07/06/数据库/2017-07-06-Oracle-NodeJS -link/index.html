<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>Oracle Node.js 连接Oracle ERP数据库测试</title><meta name="description" content="观天之道，执天之行"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/highlight-theme-light.css"><script src="/jslib/highlight.pack.js"></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Robin's blog" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-mobile"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Robin's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Oracle Node.js 连接Oracle ERP数据库测试</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Oracle-NodeJS-%E6%B5%8B%E8%AF%95"><span class="toc-text">Oracle-NodeJS 测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-Node-js"><span class="toc-text">安装 Node.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-Oracle-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">安装 Oracle 客户端</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Download-the-desired-Instant-Client-ZIP-files-All-installations-require-the-Basic-or-Basic-Light-package"><span class="toc-text">1. Download the desired Instant Client ZIP files. All installations require the Basic or Basic Light package.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Unzip-the-packages-into-a-single-directory-such-as-opt-oracle-instantclient-12-2-that-is-accessible-to-your-application-For-example"><span class="toc-text">2. Unzip the packages into a single directory such as &#x2F;opt&#x2F;oracle&#x2F;instantclient_12_2 that is accessible to your application. For example:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Create-the-appropriate-libclntsh-so-and-libocci-so-links-for-the-version-of-Instant-Client-For-example"><span class="toc-text">3. Create the appropriate libclntsh.so and libocci.so links for the version of Instant Client. For example:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Install-the-libaio-package-for-example-on-Oracle-Linux-run-this-as-the-root-user"><span class="toc-text">4. Install the libaio package, for example on Oracle Linux, run this as the root user:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Set-the-environment-variable-LD-LIBRARY-PATH-to-the-directory-created-in-Step-2-for-example"><span class="toc-text">5. Set the environment variable LD_LIBRARY_PATH to the directory created in Step 2, for example:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-To-use-supplied-binaries-such-as-SQL-Plus-update-your-PATH-environment-variable-for-example"><span class="toc-text">6. To use supplied binaries such as SQL*Plus, update your PATH environment variable, for example:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-Start-your-application"><span class="toc-text">7. Start your application.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-the-add-on"><span class="toc-text">Install the add-on</span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/Database"><i class="tag post-item-tag">Database</i></a><a href="/tags/Oracle"><i class="tag post-item-tag">Oracle</i></a><a href="/tags/Nodejs"><i class="tag post-item-tag">Nodejs</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Oracle Node.js 连接Oracle ERP数据库测试</h1><time class="has-text-grey" datetime="2017-07-06T00:00:00.000Z">2017-07-06</time><article class="mt-2 post-content"><h2 id="Oracle-NodeJS-测试"><a href="#Oracle-NodeJS-测试" class="headerlink" title="Oracle-NodeJS 测试"></a>Oracle-NodeJS 测试</h2><h3 id="安装-Node-js"><a href="#安装-Node-js" class="headerlink" title="安装 Node.js"></a>安装 Node.js</h3><p>Download and extract the Node.js “Linux Binaries” package. For example, if you downloaded version 6.9.4 for 64-bit you could install Node.js into /opt:</p>
<pre><code>cd /opt
tar -Jxf node-v6.9.4-linux-x64.tar.xz</code></pre>
<p>Set PATH to include Node.js:</p>
<pre><code>export PATH=/opt/node-v6.9.4-linux-x64/bin:$PATH</code></pre>
<h3 id="安装-Oracle-客户端"><a href="#安装-Oracle-客户端" class="headerlink" title="安装 Oracle 客户端"></a>安装 Oracle 客户端</h3><p>See the Instant Client Home Page for more information. </p>
<p>Installation of ZIP files: </p>
<h4 id="1-Download-the-desired-Instant-Client-ZIP-files-All-installations-require-the-Basic-or-Basic-Light-package"><a href="#1-Download-the-desired-Instant-Client-ZIP-files-All-installations-require-the-Basic-or-Basic-Light-package" class="headerlink" title="1. Download the desired Instant Client ZIP files. All installations require the Basic or Basic Light package."></a>1. Download the desired Instant Client ZIP files. All installations require the Basic or Basic Light package.</h4><pre><code>drwxr-xr-x 3 root root     4096 Jul  6 10:26 instantclient_12_2/
-rw-r--r-- 1 root root 68965195 Jul  6 10:18 instantclient-basic-linux.x64-12.2.0.1.0.zip
-rw-r--r-- 1 root root   674743 Jul  6 10:17 instantclient-sdk-linux.x64-12.2.0.1.0.zip
-rw-r--r-- 1 root root   904309 Jul  6 10:17 instantclient-sqlplus-linux.x64-12.2.0.1.0.zip
-rw-r--r-- 1 root root  1132671 Jul  6 10:17 instantclient-tools-linux.x64-12.2.0.1.0.zip</code></pre>
<h4 id="2-Unzip-the-packages-into-a-single-directory-such-as-opt-oracle-instantclient-12-2-that-is-accessible-to-your-application-For-example"><a href="#2-Unzip-the-packages-into-a-single-directory-such-as-opt-oracle-instantclient-12-2-that-is-accessible-to-your-application-For-example" class="headerlink" title="2. Unzip the packages into a single directory such as /opt/oracle/instantclient_12_2 that is accessible to your application. For example:"></a>2. Unzip the packages into a single directory such as /opt/oracle/instantclient_12_2 that is accessible to your application. For example:</h4><pre><code>cd /opt/oracle            
unzip instantclient-basic-linux.x64-12.2.0.1.0.zip</code></pre>
<h4 id="3-Create-the-appropriate-libclntsh-so-and-libocci-so-links-for-the-version-of-Instant-Client-For-example"><a href="#3-Create-the-appropriate-libclntsh-so-and-libocci-so-links-for-the-version-of-Instant-Client-For-example" class="headerlink" title="3. Create the appropriate libclntsh.so and libocci.so links for the version of Instant Client. For example:"></a>3. Create the appropriate libclntsh.so and libocci.so links for the version of Instant Client. For example:</h4><pre><code>cd /opt/oracle/instantclient_12_2
ln -s libclntsh.so.12.1 libclntsh.so
ln -s libocci.so.12.1 libocci.so</code></pre>
<h4 id="4-Install-the-libaio-package-for-example-on-Oracle-Linux-run-this-as-the-root-user"><a href="#4-Install-the-libaio-package-for-example-on-Oracle-Linux-run-this-as-the-root-user" class="headerlink" title="4. Install the libaio package, for example on Oracle Linux, run this as the root user:"></a>4. Install the libaio package, for example on Oracle Linux, run this as the root user:</h4><pre><code>yum install libaio
-- apt-get install libaio1</code></pre>
<p>On some Linux distributions the package is called libaio1.</p>
<h4 id="5-Set-the-environment-variable-LD-LIBRARY-PATH-to-the-directory-created-in-Step-2-for-example"><a href="#5-Set-the-environment-variable-LD-LIBRARY-PATH-to-the-directory-created-in-Step-2-for-example" class="headerlink" title="5. Set the environment variable LD_LIBRARY_PATH to the directory created in Step 2, for example:"></a>5. Set the environment variable LD_LIBRARY_PATH to the directory created in Step 2, for example:</h4><pre><code>export LD_LIBRARY_PATH=/opt/oracle/instantclient_12_2:$LD_LIBRARY_PATH</code></pre>
<p>Alternatively, add this path to an ldconfig configuration file if there is no other Oracle software that will be impacted.</p>
<h4 id="6-To-use-supplied-binaries-such-as-SQL-Plus-update-your-PATH-environment-variable-for-example"><a href="#6-To-use-supplied-binaries-such-as-SQL-Plus-update-your-PATH-environment-variable-for-example" class="headerlink" title="6. To use supplied binaries such as SQL*Plus, update your PATH environment variable, for example:"></a>6. To use supplied binaries such as SQL*Plus, update your PATH environment variable, for example:</h4><pre><code>export PATH=/opt/oracle/instantclient_12_2:$PATH</code></pre>
<h4 id="7-Start-your-application"><a href="#7-Start-your-application" class="headerlink" title="7. Start your application."></a>7. Start your application.</h4><h3 id="Install-the-add-on"><a href="#Install-the-add-on" class="headerlink" title="Install the add-on"></a>Install the add-on</h3><p>Tell the installer where to find Instant Client:</p>
<pre><code class="bash">export OCI_LIB_DIR=/opt/oracle/instantclient_12_2
export OCI_INC_DIR=/opt/oracle/instantclient_12_2/sdk/include

npm config set python /usr/bin/python2.7
npm install oracledb</code></pre>
<p>编辑 <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/zhengr/zhengr.github.io/master/assets/files/select.js">select.js</a></p>
<pre><code class="js">var oracledb = require(&#39;oracledb&#39;);

oracledb.getConnection(
  &#123;
    user          : &quot;apps&quot;,
    password      : &quot;apps&quot;,
    connectString : &quot;192.168.1.60:1530/VIS&quot;
  &#125;,
  function(err, connection)
  &#123;
    if (err) &#123; console.error(err.message); return; &#125;
    connection.execute(
      &quot;SELECT WN.NOTIFICATION_ID,&quot;
+               &quot; WN.FROM_USER, &quot;
+               &quot; DECODE(WN.MORE_INFO_ROLE, &quot;
+                      &quot; NULL, &quot;
+                      &quot; WN.TO_USER, &quot;
+                      &quot; wf_directory.GetRoleDisplayName(WN.MORE_INFO_ROLE)) AS TO_USER, &quot;
+               &quot; DECODE(WN.MORE_INFO_ROLE, &quot;
+                      &quot; NULL, &quot;
+                      &quot; WN.SUBJECT, &quot;
+                      &quot; FND_MESSAGE.GET_STRING(&#39;FND&#39;, &#39;FND_MORE_INFO_REQUESTED&#39;) || &#39; &#39; || &quot;
+                      &quot; WN.SUBJECT) AS SUBJECT, &quot;
+               &quot; WN.LANGUAGE, &quot;
+               &quot; WN.BEGIN_DATE, &quot;
+               &quot; WN.DUE_DATE, &quot;
+               &quot; WN.STATUS, &quot;
+               &quot; WN.PRIORITY, &quot;
+              &quot; &#39;P&#39; AS PRIORITY_F, &quot;
+               &quot;WN.RECIPIENT_ROLE, &quot;
+              &quot; WN.END_DATE, &quot;
+              &quot; WIT.DISPLAY_NAME AS TYPE, &quot;
+              &quot; WN.MORE_INFO_ROLE, &quot;
+               &quot; WN.FROM_ROLE, &quot;
+               &quot; WN.MESSAGE_TYPE, &quot;
+               &quot; WN.MESSAGE_NAME, &quot;
+               &quot; WN.MAIL_STATUS, &quot;
+               &quot; WN.ORIGINAL_RECIPIENT &quot;
+          &quot; FROM WF_NOTIFICATIONS WN, WF_ITEM_TYPES_TL WIT, WF_LOOKUPS_TL WL &quot;
+         &quot; WHERE WN.STATUS  = &#39;OPEN&#39; &quot;
+           &quot; AND WN.message_type = WIT.name &quot;
+           &quot; AND WIT.language = userenv(&#39;LANG&#39;) &quot;
+           &quot; AND WL.lookup_type = &#39;WF_NOTIFICATION_STATUS&#39; &quot;
+           &quot; AND WN.status = WL.lookup_code &quot;
+           &quot; AND WL.language = userenv(&#39;LANG&#39;) &quot;
+           &quot; AND WN.RECIPIENT_ROLE = &#39;SYSADMIN&#39; &quot;,
      [],  // bind value 
      function(err, result)
      &#123;
        if (err) &#123; console.error(err.message); return; &#125;
        console.log(result.rows);
      &#125;);
  &#125;);</code></pre>
<pre><code class="bash">root@ubuntu:~# node select.js</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2017/09/01/%E5%8C%BA%E5%9D%97%E9%93%BE/2017-09-01-Hyperledger-Composer/" title="Hyperledger Composer Playground 安装及示例测试"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: Hyperledger Composer Playground 安装及示例测试</span></a><a class="button is-default" href="/2017/07/04/%E6%95%B0%E6%8D%AE%E5%BA%93/2017-07-04-Oracle-microcontainer%20-builder-smith/" title="Oracle microcontainer builder"><span class="has-text-weight-semibold">下一页: Oracle microcontainer builder</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="zhengr/robin-zheng-blog" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/zhengr"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml"><i class="iconfont icon-rss"></i></a><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> Robin 2021</span></p></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>