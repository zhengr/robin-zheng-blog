<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>重建 Oracle EM For EBS R12</title><meta name="description" content="观天之道，执天之行"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/highlight-theme-light.css"><script src="/jslib/highlight.pack.js"></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Robin's blog" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-mobile"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Robin's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">重建 Oracle EM For EBS R12</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%BB%BAOracle-EM-For-EBS-R12"><span class="toc-text">重建Oracle EM For EBS R12</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%A3%80%E6%9F%A5%E5%8F%82%E6%95%B0remote-login-passwordfile%E6%98%AF%E5%90%A6%E4%B8%BAEXCLUSIVE%E6%88%96SHARED"><span class="toc-text">一、检查参数remote_login_passwordfile是否为EXCLUSIVE或SHARED</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%BB%A5sys%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95"><span class="toc-text">1).以sys用户登录</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%A6%82%E6%9E%9CVALUE%E7%9A%84%E5%80%BC%E4%B8%8D%E6%98%AFEXCLUSIVE%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%94%A8%E5%A6%82%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E4%BF%AE-emote-login-passwordfile%E7%9A%84%E5%80%BC"><span class="toc-text">2).如果VALUE的值不是EXCLUSIVE，可以用如下的命令修 emote_login_passwordfile的值</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E7%94%A8%E6%88%B7%E8%A2%AB%E6%8E%88%E4%BA%88%E4%BA%86sysdba%E6%88%96%E8%80%85sysoper%E6%9D%83%E9%99%90"><span class="toc-text">二、检查是否存在用户被授予了sysdba或者sysoper权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%A0%E9%99%A4%E9%BB%98%E8%AE%A4%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95%E7%89%88%E7%9A%84EM%E5%92%8C%E9%87%8D%E5%BB%BAEM"><span class="toc-text">三、删除默认安装测试版的EM和重建EM</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-Delete-DB-Control-Repository"><span class="toc-text">1).Delete DB Control Repository</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-Delete-DB-Control-Repository-Objects-Manually"><span class="toc-text">2).Delete DB Control Repository Objects Manually</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%90%AF%E5%8A%A8-%E5%85%B3%E9%97%ADEM"><span class="toc-text">四、启动&#x2F;关闭EM</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%94%E3%80%81oracle-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%90%AF%E5%8A%A8%E7%AB%AF%E5%8F%A3%E4%BF%AE%E6%94%B9"><span class="toc-text">五、oracle 控制台启动端口修改</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%981%EF%BC%9A"><span class="toc-text">问题1：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%982%EF%BC%9A"><span class="toc-text">问题2：</span></a></li></ol></li></ol></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/Oracle"><i class="tag post-item-tag">Oracle</i></a><a href="/tags/EM"><i class="tag post-item-tag">EM</i></a><a href="/tags/EBS"><i class="tag post-item-tag">EBS</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">重建 Oracle EM For EBS R12</h1><time class="has-text-grey" datetime="2017-07-04T00:00:00.000Z">2017-07-04</time><article class="mt-2 post-content"><h2 id="重建Oracle-EM-For-EBS-R12"><a href="#重建Oracle-EM-For-EBS-R12" class="headerlink" title="重建Oracle EM For EBS R12"></a>重建Oracle EM For EBS R12</h2><p>Oracle EBS R12.1.1使用的是Oracle Database 11R1数据库,但是Oracle Database 11R1无法用像10g以前的版本那样的通过文件就可以打开alter<SID>.log,只能通过EM查看alter，而在安装EBS R12时，默认是<br>不安装EM.导致无法查看Alter的信息.</p>
<p>下面就介绍如何手工启动EM:</p>
<h3 id="一、检查参数remote-login-passwordfile是否为EXCLUSIVE或SHARED"><a href="#一、检查参数remote-login-passwordfile是否为EXCLUSIVE或SHARED" class="headerlink" title="一、检查参数remote_login_passwordfile是否为EXCLUSIVE或SHARED"></a>一、检查参数remote_login_passwordfile是否为EXCLUSIVE或SHARED</h3><h5 id="1-以sys用户登录"><a href="#1-以sys用户登录" class="headerlink" title="1).以sys用户登录"></a>1).以sys用户登录</h5><pre><code>$sqlplus /nolog
SQL&gt;conn /as sysdba
SQL&gt;show parameter remote_login_passwordfile;
NAME TYPE VALUE
--------------------------- ----------- -----------
remote_login_passwordfile string EXCLUSIVE</code></pre>
<h5 id="2-如果VALUE的值不是EXCLUSIVE，可以用如下的命令修-emote-login-passwordfile的值"><a href="#2-如果VALUE的值不是EXCLUSIVE，可以用如下的命令修-emote-login-passwordfile的值" class="headerlink" title="2).如果VALUE的值不是EXCLUSIVE，可以用如下的命令修 emote_login_passwordfile的值"></a>2).如果VALUE的值不是EXCLUSIVE，可以用如下的命令修 emote_login_passwordfile的值</h5><pre><code>SQL&gt;alter system set remote_login_passwordfile=&#39;exclusive&#39; scope=spfile;</code></pre>
<p>注:然后重启Database;</p>
<h3 id="二、检查是否存在用户被授予了sysdba或者sysoper权限"><a href="#二、检查是否存在用户被授予了sysdba或者sysoper权限" class="headerlink" title="二、检查是否存在用户被授予了sysdba或者sysoper权限"></a>二、检查是否存在用户被授予了sysdba或者sysoper权限</h3><pre><code>SQL&gt; select * from v$pwfile_users;
USERNAME SYSDB SYSOP SYSAS
---------------- ----- ----- -----
SYS TRUE TRUE FALSE</code></pre>
<p>如果全为空，请用如下命令创建密码文件:</p>
<pre><code>orapwd file=$ORACLE_HOME/dbs/orapw$ORACLE_SID password=sys entries=5;</code></pre>
<h3 id="三、删除默认安装测试版的EM和重建EM"><a href="#三、删除默认安装测试版的EM和重建EM" class="headerlink" title="三、删除默认安装测试版的EM和重建EM"></a>三、删除默认安装测试版的EM和重建EM</h3><h5 id="1-Delete-DB-Control-Repository"><a href="#1-Delete-DB-Control-Repository" class="headerlink" title="1).Delete DB Control Repository"></a>1).Delete DB Control Repository</h5><pre><code>$emca -deconfig dbcontrol db -repos drop
STARTED EMCA at Mar 19, 2010 10:51:30 AM
EM Configuration Assistant, Version 11.1.0.7.0 Production
Copyright (c) 2003, 2005, Oracle. All rights reserved.
Enter the following information:
Database SID: &lt;ORACLE_SID&gt;
Listener port number: &lt;ORACLE_PORT&gt;
Password for SYSMAN user:&lt;sysman passwd&gt;
Do you wish to continue? [yes(Y)/no(N)]: y
……</code></pre>
<h5 id="2-Delete-DB-Control-Repository-Objects-Manually"><a href="#2-Delete-DB-Control-Repository-Objects-Manually" class="headerlink" title="2).Delete DB Control Repository Objects Manually"></a>2).Delete DB Control Repository Objects Manually</h5><pre><code>SQL&gt; drop user sysman cascade;
SQL&gt; drop role MGMT_USER;
SQL&gt; drop user MGMT_VIEW cascade;
SQL&gt; drop public synonym MGMT_TARGET_BLACKOUTS;
SQL&gt; drop public synonym SETEMVIEWUSERCONTEXT;
3).create the DB Control Configuration Files and Repository
$emca -config dbcontrol db -repos create
STARTED EMCA at Mar 19, 2010 11:51:30 AM
EM Configuration Assistant, Version 11.1.0.7.0 Production
Copyright (c) 2003, 2005, Oracle. All rights reserved.
Enter the following information:
Database SID: &lt;ORACLE_SID&gt;
Listener port number: &lt;ORACLE_PORT&gt;
Password for SYS user:&lt;sys passwd&gt;
Password for DBSNMP user:&lt;sysman passwd&gt;
Password for SYSMAN user:&lt;sysman passwd&gt;
Password for SYSMAN user: Email address for notifications (optional):
Outgoing Mail (SMTP) server for notifications (optional):
-----------------------------------------------------------------
You have specified the following settings
Database ORACLE_HOME ................ &lt;ORACLE HOME&gt;
Local hostname ................ &lt;host name&gt;
Listener port number ................ &lt;ORACLE PORT&gt;
Database SID ..............
.. &lt;ORACLE SID&gt;
Email address for notifications ...............
Outgoing Mail (SMTP) server for notifications ...............
-----------------------------------------------------------------
Do you wish to continue? [yes(Y)/no(N)]: Y</code></pre>
<h3 id="四、启动-关闭EM"><a href="#四、启动-关闭EM" class="headerlink" title="四、启动/关闭EM"></a>四、启动/关闭EM</h3><pre><code>$emctl start/stop dbconsole
$ emctl start dbconsole
Oracle Enterprise Manager 11g Database Control Release 11.1.0.7.0
Copyright (c) 1996, 2008 Oracle Corporation. All rights reserved.
https://ebsdev.glccb.com:1158/em/console/aboutApplication
- An instance of Oracle Enterprise Manager 11g Database Control is already running.
$ emctl stop dbconsole
Oracle Enterprise Manager 11g Database Control Release 11.1.0.7.0
Copyright (c) 1996, 2008 Oracle Corporation. All rights reserved.
https://ebsdev.glccb.com:1158/em/console/aboutApplication
Stopping Oracle Enterprise Manager 11g Database Control ...
... Stopped.
You have mail in /usr/spool/mail/root</code></pre>
<h4 id="五、oracle-控制台启动端口修改"><a href="#五、oracle-控制台启动端口修改" class="headerlink" title="五、oracle 控制台启动端口修改"></a>五、oracle 控制台启动端口修改</h4><pre><code>$ emca -reconfig ports -dbcontrol_http_port 1159
$ emca -reconfig ports -agent_port 3939</code></pre>
<p>克隆Oracle数据库(已经启用EM)，在异机上复活数据库系统是需要将EM删除，并重建新环境下EM，在操作前需要做如下操作：</p>
<ul>
<li><p>修改emca文件(/d01/oracle/EBSTST01/db/tech_st/11.1.0/bin)<br>在emca文件中，将ORACLE_HOME修改实际路径，如下：<br>ORACLE_HOME=”/d01/oracle/EBSTST01/db/tech_st/11.1.0”</p>
</li>
<li><p>修改emctl文件(/d01/oracle/EBSTST01/db/tech_st/11.1.0/bin)<br>在emctl文件中，将ORACLE_HOME及EM_OC4J_HOME修改为实际路径，如下：<br>ORACLE_HOME=/d01/oracle/EBSTST01/db/tech_st/11.1.0及EM_OC4J_HOME=/d01/oracle/EBSTST01/db/tech_st/11.1.0/oc4j/j2ee/OC4J_DBConsole</p>
</li>
</ul>
<h5 id="问题1："><a href="#问题1：" class="headerlink" title="问题1："></a>问题1：</h5><pre><code>Sep 11, 2010 4:56:54 PM oracle.sysman.emcp.util.PlatformInterface executeCommand
CONFIG: /d01/oracle/EBSTST01/db/tech_st/11.1.0/sysman/admin/scripts/emca/emcaDbUtil[40]: /fin/db/db/tech_st/11.1.0/perl/bin/perl: n
ot found.
Sep 11, 2010 4:56:54 PM oracle.sysman.emcp.util.PlatformInterface executeCommand
CONFIG: Error executing /d01/oracle/EBSTST01/db/tech_st/11.1.0/sysman/admin/scripts/emca/emcaDbUtil /d01/oracle/EBSTST01/db/tech_st/
11.1.0/perl/lib:/d01/oracle/EBSTST01/db/tech_st/11.1.0/perl/lib/site_perl:/d01/oracle/EBSTST01/db/tech_st/11.1.0/sysman/admin/script
s:/d01/oracle/EBSTST01/db/tech_st/11.1.0/bin: /fin/db/db/tech_st/11.1.0/perl/bin/perl /d01/oracle/EBSTST01/db/tech_st/11.1.0/sysman/
admin/scripts/emca/emcaDbUtil.pl /d01/oracle/EBSTST01/db/tech_st/11.1.0 EBSTST01 SYS SYSDBA declare repos_pwd varchar2(30); view_use
r varchar2(30); view_user_pwd varchar2(30); view_user_acc_status varchar2(30); begin repos_pwd := ?; sysman.mgmt_view_priv.get_view_
user(view_user); select account_status into view_user_acc_status from sys.dba_users where upper(username) = upper ( view_user ); IF
view_user_acc_status like &#39;%LOCKED%&#39; THEN execute immediate &#39;alter user &#39; || view_user || &#39; account unlock&#39;; END I
F; IF view_user_ac
c_status like &#39;%EXPIRED%&#39; THEN sysman.mgmt_view_priv.set_view_user_creds ( repos_pwd ); sysman.mgmt_view_priv.GET_VIEW_USER_CREDS (
view_user, view_user_pwd ); execute immediate &#39;alter user &#39; || view_user || &#39; identified by &#39; || view_user_pwd || &#39;&#39;; END IF; end; 1
SYSMAN_PWD
Sep 11, 2010 4:56:54 PM oracle.sysman.emcp.EMReposConfig unlockMGMTAccount
CONFIG: Failed to unlock mgmt_view account
Sep 11, 2010 4:56:54 PM oracle.sysman.emcp.EMReposConfig invoke
SEVERE: Failed to unlock all EM-related accounts
Sep 11, 2010 4:56:54 PM oracle.sysman.emcp.EMConfig perform
SEVERE: Failed to unlock all EM-related accounts
Refer to the log file at /d01/oracle/EBSTST01/db/tech_st/11.1.0/cfgtoollogs/emca/EBSTST01/emca_2010_09_11_16_56_25.log for more deta
ils.
Sep 11, 2010 4:56:54 PM oracle.sysman.emcp.EMConfig perform
CONFIG: Stack Trace:
oracle.sysman.emcp.exception.EMConfigException: Failed to unlock all EM-related accounts
at oracle.sysman.emcp.EMReposConfig.invoke(EMReposConfig.java:335)
at oracle.sysman.emcp.EMReposConfig.invoke(EMReposConfig.java:147)
at oracle.sysman.emcp.EMConfig.perform(EMConfig.java:222)
at oracle.sysman.emcp.EMConfigAssistant.invokeEMCA(EMConfigAssistant.java:535)
at oracle.sysman.emcp.EMConfigAssistant.performConfiguration(EMConfigAssistant.java:1215)
at oracle.sysman.emcp.EMConfigAssistant.statusMain(EMConfigAssistant.java:519)
at oracle.sysman.emcp.EMConfigAssistant.main(EMConfigAssistant.java:468)
$</code></pre>
<p>解决方法： </p>
<p>修改emca.properties，具体路径如下：</p>
<pre><code>/d01/oracle/EBSTST01/db/tech_st/11.1.0/sysman/config/emca.properties
将emca.properties文件中PERLBIN修改为如下内容：
PERLBIN=/d01/oracle/EBSTST01/db/tech_st/11.1.0/perl/bin</code></pre>
<h5 id="问题2："><a href="#问题2：" class="headerlink" title="问题2："></a>问题2：</h5><pre><code>CONFIG: Creating targets.xml in state directories...
Source location: /fin/db/db/tech_st/11.1.0
Destination : /d01/oracle/EBSTST/db/tech_st/11.1.0/ebsdev.glccb.com_EBSTST
Creating directories...
Creating targets.xml...
Sep 14, 2010 11:27:06 AM oracle.sysman.emcp.util.PlatformInterface executeCommand
CONFIG: Unable to open /fin/db/db/tech_st/11.1.0/sysman/emd/targets/xml
Sep 14, 2010 11:27:06 AM oracle.sysman.emcp.util.PlatformInterface executeCommand
WARNING: Error executing /d01/oracle/EBSTST/db/tech_st/11.1.0/perl/bin/perl /d01/oracle/EBSTST/db/tech_st/11.1.0/bin/targetdeploy.pl /d01/oracle/EBSTST/db/tech_st/11.1.0/ebsdev.glccb.com_EBSTST ebsdev.glccb.com EBSTST
Sep 14, 2010 11:27:06 AM oracle.sysman.emcp.EMAgentConfig instantiateEMConfigFiles
CONFIG: Failed to deploy state dirs
Sep 14, 2010 11:27:06 AM oracle.sysman.emcp.EMConfig perform
SEVERE: Error instantiating EM configuration files
Refer to the log file at /d01/oracle/EBSTST/db/tech_st/11.1.0/cfgtoollogs/emca/EBSTST/emca_2010_09_14_11_11_20.log for more details.
Sep 14, 2010 11:27:06 AM oracle.sysman.emcp.EMConfig perform
CONFIG: Stack Trace:
oracle.sysman.emcp.exception.EMConfigExcepti
on: Error instantiating EM configuration files
at oracle.sysman.emcp.EMAgentConfig.updateAgentConfigFiles(EMAgentConfig.java:3093)
at oracle.sysman.emcp.EMAgentConfig.performConfiguration(EMAgentConfig.java:1287)
at oracle.sysman.emcp.EMAgentConfig.invoke(EMAgentConfig.java:252)
at oracle.sysman.emcp.EMAgentConfig.invoke(EMAgentConfig.java:230)
at oracle.sysman.emcp.EMConfig.perform(EMConfig.java:226)
at oracle.sysman.emcp.EMConfigAssistant.invokeEMCA(EMConfigAssistant.java:535)
at oracle.sysman.emcp.EMConfigAssistant.performConfiguration(EMConfigAssistant.java:1215)
at oracle.sysman.emcp.EMConfigAssistant.statusMain(EMConfigAssistant.java:519)
at oracle.sysman.emcp.EMConfigAssistant.main(EMConfigAssistant.java:468)</code></pre>
<p>解决方法：</p>
<p>找到targetdeploy.pl，具体路径如下：<br>/d01/oracle/EBSTST/db/tech_st/11.1.0/bin/targetdeploy.pl<br>将targetdeploy.pl文件中$ORACLE_HOME修改为如下内容：<br>$ORACLE_HOME=”/d01/oracle/EBSTST01/db/tech_st/11.1.0”;</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2017/07/06/%E6%95%B0%E6%8D%AE%E5%BA%93/2017-07-06-Oracle-NodeJS%20-link/" title="Oracle Node.js 连接Oracle ERP数据库测试"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: Oracle Node.js 连接Oracle ERP数据库测试</span></a><a class="button is-default" href="/2017/07/04/%E6%95%B0%E6%8D%AE%E5%BA%93/2017-07-04-Oracle-microcontainer%20-builder-smith/" title="Oracle microcontainer builder"><span class="has-text-weight-semibold">下一页: Oracle microcontainer builder</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="zhengr/robin-zheng-blog" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/zhengr"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml"><i class="iconfont icon-rss"></i></a><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> Robin 2021</span></p></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>